---
const pathname = Astro.url.pathname;

const navItems = [
  { href: '/work', label: 'Work' },
  { href: '/media', label: 'Media' },
  { href: '/about', label: 'About' },
  { href: '/contact', label: 'Contact' },
];

const isActive = (href: string): boolean =>
  href === '/' ? pathname === '/' : pathname.startsWith(href);
---

<header id="site-header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-300">
  <nav class="container-wide flex items-center justify-between py-5">
    <a
      href="/"
      class="header-logo font-display text-2xl font-bold no-underline transition-colors"
    >
      <span class="logo-text">Fierce</span>
      <span class="text-sienna">Highways</span>
    </a>

    <ul class="flex gap-10">
      {navItems.map(({ href, label }) => (
        <li>
          <a
            href={href}
            class:list={[
              'nav-item text-sm font-medium tracking-wider uppercase no-underline transition-all duration-300 relative',
              isActive(href) ? 'active' : '',
            ]}
          >
            {label}
          </a>
        </li>
      ))}
    </ul>
  </nav>
</header>

<!-- Spacer for fixed header -->
<div class="h-16"></div>

<style is:global>
  /* Always show solid background - simpler and more reliable */
  #site-header {
    background-color: rgba(250, 248, 245, 0.98);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-bottom: 1px solid rgba(232, 228, 222, 0.5);
  }

  #site-header.scrolled {
    box-shadow: 0 4px 30px rgba(44, 36, 32, 0.08);
  }

  /* Logo text - always dark on light header */
  #site-header .logo-text {
    color: #2C2420;
    transition: color 0.3s ease;
  }

  /* Nav items - always dark on light header */
  #site-header .nav-item {
    color: #4A423D;
    transition: color 0.3s ease;
  }

  #site-header .nav-item:hover {
    color: #8B4513;
  }

  #site-header .nav-item.active {
    color: #8B4513;
  }

  /* Underline effect */
  #site-header .nav-item::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 0;
    height: 2px;
    background-color: #8B4513;
    transition: width 0.3s cubic-bezier(0.16, 1, 0.3, 1);
  }

  #site-header .nav-item:hover::after,
  #site-header .nav-item.active::after {
    width: 100%;
  }

  #site-header .header-logo {
    font-family: var(--font-display);
  }

  #site-header .nav-item {
    font-family: var(--font-body);
  }
</style>

<script>
  const header = document.getElementById('site-header');
  let lastScroll = 0;

  const handleScroll = () => {
    const currentScroll = window.scrollY;

    if (currentScroll > 100) {
      header?.classList.add('scrolled');
    } else {
      header?.classList.remove('scrolled');
    }

    lastScroll = currentScroll;
  };

  window.addEventListener('scroll', handleScroll, { passive: true });
  handleScroll(); // Check initial state
</script>
