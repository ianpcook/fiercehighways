---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const allWork = await getCollection('work');
const featuredWork = allWork
  .filter((w) => w.data.featured)
  .sort((a, b) => b.data.publishedDate.valueOf() - a.data.publishedDate.valueOf())
  .slice(0, 3);

const allWriting = await getCollection('writing');
const recentWriting = allWriting
  .sort((a, b) => b.data.publishedDate.valueOf() - a.data.publishedDate.valueOf())
  .slice(0, 3);

const typeLabels: Record<string, string> = {
  article: 'Article',
  podcast: 'Podcast',
  talk: 'Talk',
};

const formatDate = (date: Date): string =>
  date.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

const services = [
  {
    title: 'Prototype Development',
    description: 'Working code in days, not decks in weeks. Prove the concept before you commit the budget.',
  },
  {
    title: 'Production Implementation',
    description: 'Ship what works. Take validated prototypes to production systems that scale.',
  },
  {
    title: 'Tactical AI',
    description: 'Solve the problem in front of you. No roadmaps to nowhereâ€”just the next right move.',
  },
];
---

<BaseLayout
  title="Fierce Highways | AI Prototyping & Tactical Consulting"
  description="Working AI in days, not decks in weeks. We build, prove, and shipâ€”no roadmaps to nowhere."
>
  <!-- Hero with Highway Imagery -->
  <section class="relative min-h-[90vh] flex items-center overflow-hidden grain-overlay">
    <!-- Background Image with subtle zoom -->
    <div class="absolute inset-0">
      <img
        src="https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?w=1920&q=80"
        alt="Highway stretching into the distance"
        class="w-full h-full object-cover scale-105"
        style="animation: subtle-zoom 20s ease-in-out infinite alternate;"
        loading="eager"
      />
      <div class="absolute inset-0 bg-gradient-to-r from-ink/95 via-ink/80 to-ink/50"></div>
    </div>

    <!-- Content -->
    <div class="relative container-wide py-24">
      <div class="max-w-4xl">
        <h1 class="text-6xl md:text-8xl lg:text-9xl font-display font-bold text-cream mb-6 tracking-tight text-shadow-dramatic" style="line-height: 1.1;">
          <span class="block overflow-visible">
            <span class="animate-hero-reveal inline-block">Fierce</span>
          </span>
          <span class="block overflow-visible pb-4">
            <span class="animate-hero-reveal delay-200 inline-block text-sienna">Highways</span>
          </span>
        </h1>
        <div class="w-24 h-1 bg-sienna mb-8 animate-line-expand delay-400"></div>
        <p class="text-xl md:text-2xl text-cream/90 mb-4 font-display animate-fade-up delay-500">
          AI Prototyping & Tactical Consulting
        </p>
        <p class="text-lg md:text-xl text-cream/70 max-w-xl mb-12 leading-relaxed animate-fade-up delay-600">
          You don't need a roadmap. You need to ship. We build working AI fast, prove what works, and get it into production.
        </p>
        <div class="flex flex-wrap gap-4 animate-fade-up delay-700">
          <a
            href="/contact"
            class="btn-fierce inline-block px-10 py-5 bg-sienna text-cream font-medium tracking-wide uppercase no-underline text-lg focus-ring"
          >
            Start a Project
          </a>
          <a
            href="/work"
            class="btn-outline inline-block px-10 py-5 text-cream font-medium tracking-wide uppercase no-underline focus-ring"
          >
            See the Work
          </a>
        </div>
      </div>
    </div>

    <!-- Scroll indicator -->
    <div class="absolute bottom-8 left-1/2 -translate-x-1/2 animate-fade-in delay-800">
      <a href="#services" class="block scroll-indicator" aria-label="Scroll to services section">
        <div class="w-6 h-10 border-2 border-cream/40 rounded-full flex justify-center pt-2">
          <div class="w-1 h-3 bg-cream/60 rounded-full"></div>
        </div>
      </a>
    </div>
  </section>

  <!-- Scroll Progress Bar -->
  <div class="scroll-progress" id="scroll-progress"></div>

  <!-- Services -->
  <section id="services" class="relative section-spacing overflow-hidden grain-overlay">
    <div class="absolute inset-0">
      <img
        src="https://images.unsplash.com/photo-1494783367193-149034c05e8f?w=1920&q=80"
        alt="Desert highway stretching into the distance"
        class="w-full h-full object-cover"
        style="animation: subtle-zoom 25s ease-in-out infinite alternate;"
        loading="lazy"
      />
      <div class="absolute inset-0 bg-ink/90"></div>
    </div>
    <div class="relative container-wide z-10">
      <p class="label text-sienna mb-4 scroll-reveal">What We Do</p>
      <h2 class="text-4xl md:text-5xl lg:text-6xl font-display font-bold text-cream mb-4 max-w-3xl scroll-reveal road-line text-shadow-dramatic">
        Build it. Prove it. Ship it.
      </h2>
      <p class="text-cream/60 text-lg mb-12 scroll-reveal">No decks. No delays. Just results.</p>

      <div class="grid md:grid-cols-3 gap-8 stagger-children" id="services-grid">
        {services.map(({ title, description }) => (
          <div
            class="card-bold border border-cream/20 p-10 bg-ink/50 backdrop-blur-sm hover-glow focus-ring"
            tabindex="0"
          >
            <div class="w-12 h-1 bg-sienna mb-6"></div>
            <h3 class="text-2xl font-display font-bold text-cream mb-4">{title}</h3>
            <p class="text-cream/70 leading-relaxed text-lg">{description}</p>
          </div>
        ))}
      </div>
    </div>
  </section>

  <!-- Highway Image Break with Parallax Effect -->
  <section class="relative h-96 overflow-hidden img-zoom">
    <img
      src="/images/backgrounds/winding-road.jpg"
      alt="Winding mountain road"
      class="w-full h-full object-cover"
      loading="lazy"
    />
    <div class="absolute inset-0 bg-gradient-to-b from-ink/40 via-transparent to-ink/40"></div>
    <!-- Road stripe accent on left edge -->
    <div class="absolute left-8 top-0 bottom-0 w-1 road-animated opacity-60"></div>
    <div class="absolute inset-0 flex items-center justify-center">
      <p class="text-cream/90 text-2xl md:text-4xl font-display font-bold tracking-wide text-shadow-dramatic scroll-reveal">
        The fastest route from idea to impact.
      </p>
    </div>
  </section>

  <!-- Work Preview Section -->
  <section class="section-spacing">
    <div class="container-wide">
      <p class="label text-sienna mb-4 scroll-reveal">Selected Work</p>
      <h2 class="text-3xl md:text-4xl lg:text-5xl font-display font-bold mb-4 scroll-reveal road-line">
        Projects that shipped.
      </h2>
      <p class="text-ink-light text-lg mb-10 scroll-reveal">Real results. Not slide decks.</p>

      <div class="grid md:grid-cols-3 gap-8 mb-12">
        {featuredWork.map((project, index) => (
          <a
            href={`/work/${project.slug}`}
            class="card-bold tilt-hover block border border-parchment p-8 no-underline group scroll-reveal"
            style={`transition-delay: ${index * 100}ms`}
          >
            <p class="label mb-3 text-sienna">{project.data.industry}</p>
            <h3 class="text-2xl font-display font-bold mb-4 group-hover:text-sienna transition-colors">
              {project.data.title}
            </h3>
            <p class="text-ink-light mb-6 leading-relaxed">
              {project.data.description}
            </p>
            <span class="text-sienna font-medium arrow-link">
              Read more
              <svg class="w-4 h-4 arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
              </svg>
            </span>
          </a>
        ))}
      </div>

      <a href="/work" class="arrow-link text-sienna font-medium text-lg scroll-reveal no-underline">
        View all work
        <svg class="w-5 h-5 arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
        </svg>
      </a>
    </div>
  </section>

  <!-- Philosophy Section -->
  <section class="section-spacing bg-cream-dark highway-stripes relative overflow-hidden">
    <div class="container-editorial relative z-10">
      <p class="label text-sienna mb-4 scroll-reveal">Philosophy</p>
      <h2 class="text-3xl md:text-4xl lg:text-5xl font-display font-bold mb-10 scroll-reveal">
        <span class="road-line inline-block">Tactics, not strategy.</span><br />
        <span class="text-fierce text-sienna">Code, not decks.</span>
      </h2>
      <div class="prose max-w-none">
        <p class="text-ink-light leading-relaxed mb-6 text-lg md:text-xl scroll-reveal">
          Most AI consultants deliver PowerPoints. We deliver working software. You have an immediate problemâ€”not a five-year roadmap problem. You need something that works now, that you can touch and test and ship.
        </p>
        <p class="text-ink-light leading-relaxed text-lg md:text-xl scroll-reveal">
          That's what we do. We build fast, we prove fast, we fail fast when we need to. No elaborate discovery phases. No "alignment workshops." Just the next right move, executed.
        </p>
      </div>
      <div class="mt-12 scroll-reveal">
        <a href="/about" class="arrow-link text-sienna font-medium text-lg no-underline">
          Meet the principal
          <svg class="w-5 h-5 arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
          </svg>
        </a>
      </div>
    </div>
  </section>

  <!-- Recent Writing Section -->
  <section class="section-spacing">
    <div class="container-wide">
      <p class="label text-sienna mb-4 scroll-reveal">Media</p>
      <h2 class="text-3xl md:text-4xl lg:text-5xl font-display font-bold mb-10 scroll-reveal road-line">
        Podcasts & Writing
      </h2>

      <div class="space-y-0 mb-12">
        {recentWriting.map((piece, index) => (
          <article
            class="flex gap-6 items-start py-8 border-b border-parchment last:border-0 scroll-reveal hover:bg-cream-dark/50 transition-colors -mx-4 px-4"
            style={`transition-delay: ${index * 100}ms`}
          >
            <div class="flex-1">
              <p class="label mb-2 text-sienna">{typeLabels[piece.data.type]}</p>
              <h3 class="text-xl md:text-2xl font-display font-bold mb-2">
                {piece.data.externalUrl ? (
                  <a
                    href={piece.data.externalUrl}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="no-underline hover:text-sienna transition-colors"
                  >
                    {piece.data.title}
                  </a>
                ) : (
                  <a href="/media" class="no-underline hover:text-sienna transition-colors">
                    {piece.data.title}
                  </a>
                )}
              </h3>
              <p class="text-ink-light">
                {piece.data.venue ? `${piece.data.venue} Â· ` : ''}{formatDate(piece.data.publishedDate)}
              </p>
            </div>
            <div class="hidden md:block" aria-hidden="true">
              <svg class="w-6 h-6 text-stone" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
              </svg>
            </div>
          </article>
        ))}
      </div>

      <a href="/media" class="arrow-link text-sienna font-medium text-lg scroll-reveal no-underline">
        View all media
        <svg class="w-5 h-5 arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
        </svg>
      </a>
    </div>
  </section>

  <!-- Final CTA with Highway Image -->
  <section class="relative min-h-[60vh] flex items-center overflow-hidden grain-overlay">
    <div class="absolute inset-0">
      <img
        src="https://images.unsplash.com/photo-1504204267155-aabd8eab58c3?w=1920&q=80"
        alt="Highway at dusk"
        class="w-full h-full object-cover"
        loading="lazy"
      />
      <div class="absolute inset-0 bg-gradient-to-t from-ink/95 via-ink/80 to-ink/60"></div>
    </div>

    <div class="relative container-editorial text-center py-24 z-10">
      <h2 class="text-4xl md:text-5xl lg:text-6xl font-display font-bold text-cream mb-8 text-shadow-dramatic scroll-reveal">
        Got a problem?<br />
        <span class="text-sienna">Let's solve it.</span>
      </h2>
      <p class="text-xl text-cream/80 max-w-xl mx-auto mb-12 scroll-reveal">
        Tell me what's stuck. We'll figure out the fastest path to unstuck.
      </p>
      <a
        href="/contact"
        class="btn-fierce speed-lines inline-block px-12 py-5 bg-sienna text-cream font-medium tracking-wide uppercase no-underline text-lg scroll-reveal focus-ring"
      >
        Start a Conversation
      </a>
    </div>
  </section>

  <!-- Scroll Reveal & Animation Scripts -->
  <script>
    // Scroll reveal observer
    const observerOptions = {
      root: null,
      rootMargin: '0px 0px -10% 0px',
      threshold: 0.1
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('revealed');
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);

    document.querySelectorAll('.scroll-reveal').forEach(el => {
      observer.observe(el);
    });

    // Stagger children observer
    document.querySelectorAll('.stagger-children').forEach(el => {
      observer.observe(el);
    });

    // Scroll progress bar
    const scrollProgress = document.getElementById('scroll-progress');
    const updateScrollProgress = () => {
      const scrollTop = window.scrollY;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      const scrollPercent = scrollTop / docHeight;
      if (scrollProgress) {
        scrollProgress.style.transform = `scaleX(${scrollPercent})`;
      }
    };
    window.addEventListener('scroll', updateScrollProgress, { passive: true });


    // Smooth scroll for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });

    // Respect reduced motion preference
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      document.querySelectorAll('.scroll-reveal, .stagger-children').forEach(el => {
        el.classList.add('revealed');
      });
      if (scrollProgress) scrollProgress.style.display = 'none';
    }

    // Console easter egg for developers
    console.log(`
%cðŸ›£ï¸ FIERCE HIGHWAYS %c

Tactics, not strategy. Code, not decks.

Looking under the hood? Good instinct.
That's the kind of curiosity that builds great AI.

Let's talk: hello@fiercehighways.ai

    `,
    'font-size: 20px; font-weight: bold; color: #8B4513;',
    'font-size: 12px; color: #4A423D;'
    );

    // Add subtle "speed lines" effect to buttons on fast mouse movement
    const speedButtons = document.querySelectorAll('.speed-lines');
    let lastX = 0;
    let lastTime = Date.now();

    document.addEventListener('mousemove', (e) => {
      const now = Date.now();
      const deltaX = Math.abs(e.clientX - lastX);
      const deltaTime = now - lastTime;

      if (deltaTime > 0) {
        const speed = deltaX / deltaTime;

        speedButtons.forEach(btn => {
          const rect = btn.getBoundingClientRect();
          const isNear = e.clientY > rect.top - 50 &&
                         e.clientY < rect.bottom + 50 &&
                         e.clientX > rect.left - 100 &&
                         e.clientX < rect.right + 100;

          if (isNear && speed > 1.5) {
            btn.classList.add('speed-active');
            setTimeout(() => btn.classList.remove('speed-active'), 300);
          }
        });
      }

      lastX = e.clientX;
      lastTime = now;
    }, { passive: true });

    // Add satisfying click feedback
    document.querySelectorAll('.btn-fierce, .card-bold').forEach(el => {
      el.addEventListener('mousedown', function() {
        this.style.transform = 'scale(0.98)';
      });
      el.addEventListener('mouseup', function() {
        this.style.transform = '';
      });
      el.addEventListener('mouseleave', function() {
        this.style.transform = '';
      });
    });
  </script>
</BaseLayout>
